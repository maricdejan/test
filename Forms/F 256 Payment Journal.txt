OBJECT Form 256 Payment Journal
{
  OBJECT-PROPERTIES
  {
    Date=05.11.08;
    Time=12:00:00;
    Version List=NAVW16.00,NAVDACH6.00;
  }
  PROPERTIES
  {
    Width=17050;
    Height=9130;
    CaptionML=[DEU=Zahlungsausgangs Buch.-Blatt;
               ENU=Payment Journal];
    SaveValues=Yes;
    TableBoxID=1;
    SourceTable=Table81;
    AutoSplitKey=Yes;
    DelayedInsert=Yes;
    DataCaptionFields=Journal Batch Name;
    OnOpenForm=VAR
                 JnlSelected@1000 : Boolean;
               BEGIN
                 BalAccName := '';
                 OpenedFromBatch := ("Journal Batch Name" <> '') AND ("Journal Template Name" = '');
                 IF OpenedFromBatch THEN BEGIN
                   CurrentJnlBatchName := "Journal Batch Name";
                   GenJnlManagement.OpenJnl(CurrentJnlBatchName,Rec);
                   EXIT;
                 END;
                 GenJnlManagement.TemplateSelection(FORM::"Payment Journal",4,FALSE,Rec,JnlSelected);
                 IF NOT JnlSelected THEN
                   ERROR('');
                 GenJnlManagement.OpenJnl(CurrentJnlBatchName,Rec);
               END;

    OnAfterGetRecord=BEGIN
                       ShowShortcutDimCode(ShortcutDimCode);
                     END;

    OnAfterGetCurrRecord=BEGIN
                           GenJnlManagement.GetAccounts(Rec,AccName,BalAccName);
                           UpdateBalance;

                           UpdateInfoBox;
                         END;

    OnBeforePutRecord=BEGIN
                        UpdateBalance;
                      END;

    OnNewRecord=BEGIN
                  UpdateBalance;
                  SetUpNewLine(xRec,Balance,BelowxRec);
                  CLEAR(ShortcutDimCode);

                  IF "Document Type" = "Document Type"::" " THEN BEGIN
                    "Document Type" := "Document Type"::Payment;
                    "Account Type" := "Account Type"::Vendor;
                  END;
                END;

  }
  CONTROLS
  {
    { 1   ;TableBox     ;220  ;880  ;16610;5060 ;HorzGlue=Both;
                                                 VertGlue=Both }
    { 2   ;TextBox      ;0    ;0    ;1650 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Posting Date" }
    { 3   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=2;
                                                 InColumnHeading=Yes }
    { 35  ;TextBox      ;1270 ;1320 ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Document Date" }
    { 36  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=35;
                                                 InColumnHeading=Yes }
    { 4   ;TextBox      ;0    ;0    ;550  ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Document Type" }
    { 5   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=4;
                                                 InColumnHeading=Yes }
    { 6   ;TextBox      ;0    ;0    ;1650 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Document No." }
    { 7   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=6;
                                                 InColumnHeading=Yes }
    { 83  ;TextBox      ;5609 ;1100 ;1650 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="External Document No." }
    { 84  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=83;
                                                 InColumnHeading=Yes }
    { 8   ;TextBox      ;0    ;0    ;550  ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Account Type";
                                                 OnValidate=BEGIN
                                                              GenJnlManagement.GetAccounts(Rec,AccName,BalAccName);
                                                            END;
                                                             }
    { 9   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=8;
                                                 InColumnHeading=Yes }
    { 10  ;TextBox      ;0    ;0    ;1650 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Account No.";
                                                 OnValidate=BEGIN
                                                              GenJnlManagement.GetAccounts(Rec,AccName,BalAccName);
                                                              ShowShortcutDimCode(ShortcutDimCode);
                                                            END;
                                                             }
    { 11  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=10;
                                                 InColumnHeading=Yes }
    { 12  ;TextBox      ;0    ;0    ;4400 ;0    ;HorzGlue=Both;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Description }
    { 13  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=12;
                                                 InColumnHeading=Yes }
    { 53  ;TextBox      ;13361;1210 ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Salespers./Purch. Code" }
    { 54  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=53;
                                                 InColumnHeading=Yes }
    { 95  ;TextBox      ;14632;2970 ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Campaign No." }
    { 96  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=95;
                                                 InColumnHeading=Yes }
    { 55  ;TextBox      ;14896;1430 ;1100 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 AssistEdit=Yes;
                                                 SourceExpr="Currency Code";
                                                 OnAssistEdit=BEGIN
                                                                ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date");
                                                                IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                                                  VALIDATE("Currency Factor",ChangeExchangeRate.GetParameter);
                                                                END;
                                                                CLEAR(ChangeExchangeRate);
                                                              END;
                                                               }
    { 56  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=55;
                                                 InColumnHeading=Yes }
    { 77  ;TextBox      ;19923;1320 ;550  ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Gen. Posting Type" }
    { 78  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=77;
                                                 InColumnHeading=Yes }
    { 79  ;TextBox      ;20473;1320 ;550  ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Gen. Bus. Posting Group" }
    { 80  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=79;
                                                 InColumnHeading=Yes }
    { 81  ;TextBox      ;22123;1320 ;550  ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Gen. Prod. Posting Group" }
    { 82  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=81;
                                                 InColumnHeading=Yes }
    { 85  ;TextBox      ;23760;1100 ;550  ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="VAT Bus. Posting Group" }
    { 86  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=85;
                                                 InColumnHeading=Yes }
    { 87  ;TextBox      ;25410;1100 ;550  ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="VAT Prod. Posting Group" }
    { 88  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=87;
                                                 InColumnHeading=Yes }
    { 14  ;TextBox      ;0    ;0    ;2200 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Amount }
    { 15  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=14;
                                                 InColumnHeading=Yes }
    { 97  ;TextBox      ;22437;3190 ;2200 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="VAT Amount" }
    { 98  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=97;
                                                 InColumnHeading=Yes }
    { 101 ;TextBox      ;9128 ;3300 ;2200 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="VAT Difference" }
    { 102 ;Label        ;0    ;0    ;0    ;0    ;ParentControl=101;
                                                 InColumnHeading=Yes }
    { 99  ;TextBox      ;24606;2860 ;2200 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Bal. VAT Amount" }
    { 100 ;Label        ;0    ;0    ;0    ;0    ;ParentControl=99;
                                                 InColumnHeading=Yes }
    { 103 ;TextBox      ;11328;3300 ;2200 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Bal. VAT Difference" }
    { 104 ;Label        ;0    ;0    ;0    ;0    ;ParentControl=103;
                                                 InColumnHeading=Yes }
    { 61  ;TextBox      ;21008;1100 ;550  ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Bal. Account Type" }
    { 62  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=61;
                                                 InColumnHeading=Yes }
    { 16  ;TextBox      ;0    ;0    ;1650 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Bal. Account No.";
                                                 OnValidate=BEGIN
                                                              GenJnlManagement.GetAccounts(Rec,AccName,BalAccName);
                                                              ShowShortcutDimCode(ShortcutDimCode);
                                                            END;
                                                             }
    { 17  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=16;
                                                 InColumnHeading=Yes }
    { 71  ;TextBox      ;37942;1320 ;550  ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Bal. Gen. Posting Type" }
    { 72  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=71;
                                                 InColumnHeading=Yes }
    { 73  ;TextBox      ;38492;1320 ;550  ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Bal. Gen. Bus. Posting Group" }
    { 74  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=73;
                                                 InColumnHeading=Yes }
    { 75  ;TextBox      ;40142;1320 ;550  ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Bal. Gen. Prod. Posting Group" }
    { 76  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=75;
                                                 InColumnHeading=Yes }
    { 89  ;TextBox      ;30136;1100 ;550  ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Bal. VAT Bus. Posting Group" }
    { 90  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=89;
                                                 InColumnHeading=Yes }
    { 91  ;TextBox      ;31786;1100 ;550  ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Bal. VAT Prod. Posting Group" }
    { 92  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=91;
                                                 InColumnHeading=Yes }
    { 49  ;TextBox      ;9922 ;1320 ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Shortcut Dimension 1 Code" }
    { 50  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=49;
                                                 InColumnHeading=Yes }
    { 51  ;TextBox      ;11642;1210 ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Shortcut Dimension 2 Code" }
    { 52  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=51;
                                                 InColumnHeading=Yes }
    { 300 ;TextBox      ;41936;1100 ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=ShortcutDimCode[3];
                                                 CaptionClass='1,2,3';
                                                 OnValidate=BEGIN
                                                              ValidateShortcutDimCode(3,ShortcutDimCode[3]);
                                                            END;

                                                 OnLookup=BEGIN
                                                            LookupShortcutDimCode(3,ShortcutDimCode[3]);
                                                          END;
                                                           }
    { 301 ;Label        ;0    ;0    ;0    ;0    ;ParentControl=300;
                                                 InColumnHeading=Yes }
    { 302 ;TextBox      ;43498;1100 ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=ShortcutDimCode[4];
                                                 CaptionClass='1,2,4';
                                                 OnValidate=BEGIN
                                                              ValidateShortcutDimCode(4,ShortcutDimCode[4]);
                                                            END;

                                                 OnLookup=BEGIN
                                                            LookupShortcutDimCode(4,ShortcutDimCode[4]);
                                                          END;
                                                           }
    { 303 ;Label        ;0    ;0    ;0    ;0    ;ParentControl=302;
                                                 InColumnHeading=Yes }
    { 304 ;TextBox      ;45191;990  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=ShortcutDimCode[5];
                                                 CaptionClass='1,2,5';
                                                 OnValidate=BEGIN
                                                              ValidateShortcutDimCode(5,ShortcutDimCode[5]);
                                                            END;

                                                 OnLookup=BEGIN
                                                            LookupShortcutDimCode(5,ShortcutDimCode[5]);
                                                          END;
                                                           }
    { 305 ;Label        ;0    ;0    ;0    ;0    ;ParentControl=304;
                                                 InColumnHeading=Yes }
    { 306 ;TextBox      ;46779;1100 ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=ShortcutDimCode[6];
                                                 CaptionClass='1,2,6';
                                                 OnValidate=BEGIN
                                                              ValidateShortcutDimCode(6,ShortcutDimCode[6]);
                                                            END;

                                                 OnLookup=BEGIN
                                                            LookupShortcutDimCode(6,ShortcutDimCode[6]);
                                                          END;
                                                           }
    { 307 ;Label        ;0    ;0    ;0    ;0    ;ParentControl=306;
                                                 InColumnHeading=Yes }
    { 308 ;TextBox      ;48578;1100 ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=ShortcutDimCode[7];
                                                 CaptionClass='1,2,7';
                                                 OnValidate=BEGIN
                                                              ValidateShortcutDimCode(7,ShortcutDimCode[7]);
                                                            END;

                                                 OnLookup=BEGIN
                                                            LookupShortcutDimCode(7,ShortcutDimCode[7]);
                                                          END;
                                                           }
    { 309 ;Label        ;0    ;0    ;0    ;0    ;ParentControl=308;
                                                 InColumnHeading=Yes }
    { 310 ;TextBox      ;50165;1100 ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=ShortcutDimCode[8];
                                                 CaptionClass='1,2,8';
                                                 OnValidate=BEGIN
                                                              ValidateShortcutDimCode(8,ShortcutDimCode[8]);
                                                            END;

                                                 OnLookup=BEGIN
                                                            LookupShortcutDimCode(8,ShortcutDimCode[8]);
                                                          END;
                                                           }
    { 311 ;Label        ;0    ;0    ;0    ;0    ;ParentControl=310;
                                                 InColumnHeading=Yes }
    { 1140002;CheckBox  ;51144;1100 ;1650 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 ShowCaption=No;
                                                 SourceExpr=Correction }
    { 1140003;Label     ;0    ;0    ;0    ;0    ;ParentControl=1140002;
                                                 InColumnHeading=Yes }
    { 18  ;TextBox      ;0    ;0    ;550  ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Applies-to Doc. Type" }
    { 19  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=18;
                                                 InColumnHeading=Yes }
    { 20  ;TextBox      ;0    ;0    ;1650 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Applies-to Doc. No." }
    { 21  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=20;
                                                 InColumnHeading=Yes }
    { 22  ;TextBox      ;0    ;0    ;1650 ;0    ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Applies-to ID" }
    { 23  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=22;
                                                 InColumnHeading=Yes }
    { 105 ;TextBox      ;52652;2750 ;1700 ;440  ;Name=GetAppliesToDocDueDate;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 CaptionML=[DEU=FÑlligkeitsdatum fÅr Ausgleich mit Beleg;
                                                            ENU=Applies-to Doc. Due Date];
                                                 SourceExpr=GetAppliesToDocDueDate }
    { 106 ;Label        ;0    ;0    ;0    ;0    ;ParentControl=105;
                                                 InColumnHeading=Yes }
    { 67  ;TextBox      ;27675;1320 ;550  ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Bank Payment Type" }
    { 68  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=67;
                                                 InColumnHeading=Yes }
    { 59  ;CheckBox     ;13600;1210 ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 ShowCaption=No;
                                                 SourceExpr="Check Printed" }
    { 60  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=59;
                                                 InColumnHeading=Yes }
    { 69  ;TextBox      ;29951;1210 ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Reason Code" }
    { 70  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=69;
                                                 InColumnHeading=Yes }
    { 24  ;Frame        ;220  ;6160 ;16610;1980 ;HorzGlue=Both;
                                                 VertGlue=Bottom;
                                                 ShowCaption=No }
    { 1150000;TextBox   ;14630;7480 ;1980 ;440  ;Name=TotalBalance;
                                                 HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Editable=No;
                                                 ParentControl=24;
                                                 InFrame=Yes;
                                                 CaptionML=[DEU=Gesamtsaldo;
                                                            ENU=Total Balance];
                                                 ToolTipML=[DEU=Gesamtsaldo in MW;
                                                            ENU=Total balance in LCY];
                                                 SourceExpr=TotalBalance+"Balance (LCY)"-xRec."Balance (LCY)";
                                                 AutoFormatType=1 }
    { 1150001;Label     ;13200;7480 ;1320 ;440  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 ParentControl=1150000;
                                                 HorzAlign=Left;
                                                 LeaderDots=No }
    { 1150002;TextBox   ;14630;6930 ;1980 ;440  ;Name=Balance;
                                                 HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Editable=No;
                                                 ParentControl=24;
                                                 InFrame=Yes;
                                                 CaptionML=[DEU=Saldo;
                                                            ENU=Balance];
                                                 ToolTipML=[DEU=Saldo in MW bis aktuelle Zeile;
                                                            ENU=Balance in LCY to actual line];
                                                 SourceExpr=Balance+"Balance (LCY)"-xRec."Balance (LCY)";
                                                 AutoFormatType=1 }
    { 1150003;Label     ;13200;6930 ;1320 ;440  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 ParentControl=1150002;
                                                 HorzAlign=Left;
                                                 LeaderDots=No }
    { 1150004;TextBox   ;12210;6930 ;770  ;440  ;VertGlue=Bottom;
                                                 Editable=No;
                                                 ParentControl=24;
                                                 InFrame=Yes;
                                                 CaptionML=[DEU=FÑllig;
                                                            ENU=Due];
                                                 ToolTipML=[DEU=Anz. Tage bis FÑlligkeit des offenen Postens;
                                                            ENU=Number of days until due date of open entry];
                                                 BlankZero=Yes;
                                                 SourceExpr=DueDays }
    { 1150005;TextBox   ;12210;7480 ;770  ;440  ;VertGlue=Bottom;
                                                 Editable=No;
                                                 ParentControl=24;
                                                 InFrame=Yes;
                                                 CaptionML=[DEU=Skonto;
                                                            ENU=Cash Discount];
                                                 ToolTipML=[DEU=Tage bis Skontodatum;
                                                            ENU=Days to payment disc. date];
                                                 BlankZero=Yes;
                                                 SourceExpr=PaymDiscDays }
    { 1150006;TextBox   ;12210;6380 ;770  ;440  ;VertGlue=Bottom;
                                                 Editable=No;
                                                 ParentControl=24;
                                                 InFrame=Yes;
                                                 CaptionML=[DEU=Alter;
                                                            ENU=Age];
                                                 ToolTipML=[DEU=Anz. Tage seit Buchung des offenen Postens;
                                                            ENU=Number of days since posting date of open entry];
                                                 BlankZero=Yes;
                                                 SourceExpr=AgeDays }
    { 1150007;TextBox   ;14630;6380 ;1980 ;440  ;Name=TotalPayment;
                                                 HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Editable=No;
                                                 ParentControl=24;
                                                 InFrame=Yes;
                                                 CaptionML=[DEU=Zahlungen;
                                                            ENU=Payments];
                                                 ToolTipML=[DEU=Zahlung gesamt in LandeswÑhrung;
                                                            ENU=Total of payments in local currency];
                                                 SourceExpr=TotalPayAmount;
                                                 AutoFormatType=1 }
    { 1150008;Label     ;13200;6380 ;1320 ;440  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 ParentControl=1150007;
                                                 HorzAlign=Left;
                                                 LeaderDots=No }
    { 1150009;TextBox   ;10670;6930 ;1430 ;440  ;VertGlue=Bottom;
                                                 Editable=No;
                                                 ParentControl=24;
                                                 InFrame=Yes;
                                                 CaptionML=[DEU=FÑllig;
                                                            ENU=Due];
                                                 ToolTipML=[DEU=FÑlligkeitsdatum des offenen Postens;
                                                            ENU=Due date of open entry];
                                                 BlankZero=Yes;
                                                 SourceExpr=VendLedgEntry."Due Date" }
    { 1150010;TextBox   ;10670;7480 ;1430 ;440  ;VertGlue=Bottom;
                                                 Editable=No;
                                                 ParentControl=24;
                                                 InFrame=Yes;
                                                 CaptionML=[DEU=Skonto;
                                                            ENU=Cash Discount];
                                                 ToolTipML=[DEU=Skontodatum des offenen Postens;
                                                            ENU=Payment disc. date of open entry];
                                                 BlankZero=Yes;
                                                 SourceExpr=VendLedgEntry."Pmt. Discount Date" }
    { 1150011;TextBox   ;10670;6380 ;1430 ;440  ;VertGlue=Bottom;
                                                 Editable=No;
                                                 ParentControl=24;
                                                 InFrame=Yes;
                                                 CaptionML=[DEU=Alter;
                                                            ENU=Age];
                                                 ToolTipML=[DEU=Buchungsdatum des offenen Postens;
                                                            ENU=Posting date of open entry];
                                                 BlankZero=Yes;
                                                 SourceExpr=VendLedgEntry."Posting Date" }
    { 1150012;Label     ;9240 ;6930 ;1320 ;440  ;VertGlue=Bottom;
                                                 ParentControl=1150004;
                                                 InFrame=Yes;
                                                 LeaderDots=No }
    { 1150013;Label     ;9240 ;7480 ;1320 ;440  ;VertGlue=Bottom;
                                                 ParentControl=1150005;
                                                 InFrame=Yes;
                                                 LeaderDots=No }
    { 1150014;Label     ;9240 ;6380 ;1320 ;440  ;VertGlue=Bottom;
                                                 ParentControl=1150006;
                                                 InFrame=Yes;
                                                 LeaderDots=No }
    { 1150015;TextBox   ;7700 ;6380 ;1320 ;440  ;VertGlue=Bottom;
                                                 Editable=No;
                                                 ParentControl=24;
                                                 InFrame=Yes;
                                                 CaptionML=[DEU=Skonto;
                                                            ENU=Pmt. Discount];
                                                 ToolTipML=[DEU=Skonto mîglich;
                                                            ENU=Payment discount possible];
                                                 SourceExpr=PmtDiscount }
    { 1150018;Label     ;6270 ;6380 ;1320 ;440  ;VertGlue=Bottom;
                                                 ParentControl=1150015;
                                                 LeaderDots=No }
    { 1150016;TextBox   ;7700 ;7480 ;1320 ;440  ;VertGlue=Bottom;
                                                 Editable=No;
                                                 ParentControl=24;
                                                 InFrame=Yes;
                                                 CaptionML=[DEU=Zahlungstoleranz;
                                                            ENU=Pmt. Tolerance];
                                                 ToolTipML=[DEU=Akzeptierte Zahlungstoleranz;
                                                            ENU=Accepted payment tolerance];
                                                 SourceExpr=AcceptedPaymentTol }
    { 1150019;Label     ;6270 ;7480 ;1320 ;440  ;VertGlue=Bottom;
                                                 ParentControl=1150016;
                                                 LeaderDots=No }
    { 1150017;TextBox   ;7700 ;6930 ;1320 ;440  ;VertGlue=Bottom;
                                                 Editable=No;
                                                 ParentControl=24;
                                                 InFrame=Yes;
                                                 CaptionML=[DEU=Abzug;
                                                            ENU=Deduction];
                                                 ToolTipML=[DEU="Abzug akzeptierter Skonto ";
                                                            ENU="Accepted payment discount deduction "];
                                                 SourceExpr=PaymDiscDeductAmount }
    { 1150020;Label     ;6270 ;6930 ;1320 ;440  ;VertGlue=Bottom;
                                                 ParentControl=1150017;
                                                 LeaderDots=No }
    { 1150021;TextBox   ;4290 ;6380 ;1760 ;440  ;VertGlue=Bottom;
                                                 Editable=No;
                                                 ParentControl=24;
                                                 InFrame=Yes;
                                                 CaptionML=[DEU=Offener Betr.;
                                                            ENU=Open Amt.];
                                                 ToolTipML=[DEU=Restbetrag des offenen Postens;
                                                            ENU=Remaining amount of open entry];
                                                 SourceExpr=OeRemainAmountFC }
    { 1150024;Label     ;2860 ;6380 ;1320 ;440  ;VertGlue=Bottom;
                                                 ParentControl=1150021;
                                                 LeaderDots=No }
    { 1150022;TextBox   ;4290 ;6930 ;1760 ;440  ;VertGlue=Bottom;
                                                 Editable=No;
                                                 ParentControl=24;
                                                 InFrame=Yes;
                                                 CaptionML=[DEU=Zahlung;
                                                            ENU=Payment];
                                                 ToolTipML=[DEU=Zahlungsbetrag der aktuellen Zeile;
                                                            ENU=Payment amount of actual line];
                                                 SourceExpr=-Amount }
    { 1150025;Label     ;2860 ;6930 ;1320 ;440  ;VertGlue=Bottom;
                                                 ParentControl=1150022;
                                                 LeaderDots=No }
    { 1150023;TextBox   ;4290 ;7480 ;1760 ;440  ;Name=RemainAfterPayment;
                                                 VertGlue=Bottom;
                                                 Editable=No;
                                                 ParentControl=24;
                                                 InFrame=Yes;
                                                 CaptionML=[DEU=Rest nach Zahlung;
                                                            ENU=Remaining after Payment];
                                                 ToolTipML=[DEU=Restbetrag des offenen Postens nach Zahlung;
                                                            ENU=Remaining amount of open entry after payment];
                                                 SourceExpr=RemainAfterPayment }
    { 1150026;Label     ;2860 ;7480 ;1320 ;440  ;VertGlue=Bottom;
                                                 ParentControl=1150023;
                                                 LeaderDots=No }
    { 1150027;TextBox   ;440  ;6930 ;2200 ;440  ;VertGlue=Bottom;
                                                 Editable=No;
                                                 ParentControl=24;
                                                 InFrame=Yes;
                                                 CaptionML=[DEU=Name;
                                                            ENU=Name];
                                                 SourceExpr=AccName }
    { 1150028;Label     ;440  ;6380 ;2200 ;440  ;VertGlue=Bottom;
                                                 ParentControl=1150027;
                                                 LeaderDots=No }
    { 1150029;TextBox   ;440  ;7480 ;2200 ;440  ;VertGlue=Bottom;
                                                 Editable=No;
                                                 ParentControl=24;
                                                 InFrame=Yes;
                                                 CaptionML=[DEU=Zahlungsbedingungen;
                                                            ENU=Payment Terms];
                                                 ToolTipML=[DEU=Zahlungsbedingungen Kreditor;
                                                            ENU=Payment term of vendor];
                                                 SourceExpr=Vend."Payment Terms Code" }
    { 33  ;TextBox      ;3630 ;220  ;2750 ;440  ;Lookup=Yes;
                                                 CaptionML=[DEU=Buch.-Blattname;
                                                            ENU=Batch Name];
                                                 SourceExpr=CurrentJnlBatchName;
                                                 OnValidate=BEGIN
                                                              GenJnlManagement.CheckName(CurrentJnlBatchName,Rec);
                                                            END;

                                                 OnLookup=BEGIN
                                                            CurrForm.SAVERECORD;
                                                            GenJnlManagement.LookupName(CurrentJnlBatchName,Rec);
                                                            CurrForm.UPDATE(FALSE);
                                                          END;

                                                 OnAfterValidate=BEGIN
                                                                   CurrForm.SAVERECORD;
                                                                   GenJnlManagement.SetName(CurrentJnlBatchName,Rec);
                                                                   CurrForm.UPDATE(FALSE);
                                                                 END;
                                                                  }
    { 34  ;Label        ;220  ;220  ;3300 ;440  ;ParentControl=33 }
    { 37  ;MenuButton   ;4950 ;8360 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[DEU=&Konto;
                                                            ENU=A&ccount];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=38;
                                                     PushAction=RunObject;
                                                     ShortCutKey=Shift+F5;
                                                     CaptionML=[DEU=Karte;
                                                                ENU=Card];
                                                     RunObject=Codeunit 15 }
                                                   { ID=39;
                                                     PushAction=RunObject;
                                                     ShortCutKey=Ctrl+F5;
                                                     CaptionML=[DEU=&Posten;
                                                                ENU=Ledger E&ntries];
                                                     RunObject=Codeunit 14 }
                                                 }
                                                  }
    { 41  ;MenuButton   ;9790 ;8360 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[DEU=Za&hlungen;
                                                            ENU=&Payments];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=42;
                                                     Ellipsis=Yes;
                                                     CaptionML=[DEU=Zahlungsvorschlag;
                                                                ENU=Suggest Vendor Payments];
                                                     OnPush=BEGIN
                                                              CreateVendorPmtSuggestion.SetGenJnlLine(Rec);
                                                              CreateVendorPmtSuggestion.RUNMODAL;
                                                              CLEAR(CreateVendorPmtSuggestion);
                                                            END;
                                                             }
                                                   { ID=63;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=&Scheckansicht;
                                                                ENU=P&review Check];
                                                     RunObject=Form 404;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Journal Template Name=FIELD(Journal Template Name),
                                                                 Journal Batch Name=FIELD(Journal Batch Name),
                                                                 Line No.=FIELD(Line No.) }
                                                   { ID=64;
                                                     Ellipsis=Yes;
                                                     CaptionML=[DEU=Scheck &drucken;
                                                                ENU=Print Check];
                                                     OnPush=BEGIN
                                                              GenJnlLine.RESET;
                                                              GenJnlLine.COPY(Rec);
                                                              GenJnlLine.SETRANGE("Journal Template Name","Journal Template Name");
                                                              GenJnlLine.SETRANGE("Journal Batch Name","Journal Batch Name");
                                                              DocPrint.PrintCheck(GenJnlLine);
                                                              CODEUNIT.RUN(CODEUNIT::"Adjust Gen. Journal Balance",Rec);
                                                            END;
                                                             }
                                                   { ID=65;
                                                     CaptionML=[DEU=Scheck &annullieren;
                                                                ENU=Void Check];
                                                     OnPush=BEGIN
                                                              TESTFIELD("Bank Payment Type","Bank Payment Type"::"Computer Check");
                                                              TESTFIELD("Check Printed",TRUE);
                                                              IF CONFIRM(Text000,FALSE,"Document No.") THEN
                                                                CheckManagement.VoidCheck(Rec);
                                                            END;
                                                             }
                                                   { ID=66;
                                                     CaptionML=[DEU=Alle Sc&hecks annullieren;
                                                                ENU=Void &All Checks];
                                                     OnPush=BEGIN
                                                              IF CONFIRM(Text001,FALSE) THEN BEGIN
                                                                GenJnlLine.RESET;
                                                                GenJnlLine.COPY(Rec);
                                                                GenJnlLine.SETRANGE("Bank Payment Type","Bank Payment Type"::"Computer Check");
                                                                GenJnlLine.SETRANGE("Check Printed",TRUE);
                                                                IF GenJnlLine.FIND('-') THEN
                                                                  REPEAT
                                                                    GenJnlLine2 := GenJnlLine;
                                                                    CheckManagement.VoidCheck(GenJnlLine2);
                                                                  UNTIL GenJnlLine.NEXT = 0;
                                                              END;
                                                            END;
                                                             }
                                                 }
                                                  }
    { 43  ;MenuButton   ;12210;8360 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[DEU=Bu&chen;
                                                            ENU=P&osting];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=44;
                                                     ShortCutKey=Ctrl+F9;
                                                     CaptionML=[DEU=Abst&immen;
                                                                ENU=Reconcile];
                                                     OnPush=BEGIN
                                                              GLReconcile.SetGenJnlLine(Rec);
                                                              GLReconcile.RUN;
                                                            END;
                                                             }
                                                   { ID=45;
                                                     Ellipsis=Yes;
                                                     CaptionML=[DEU=Testbericht;
                                                                ENU=Test Report];
                                                     OnPush=BEGIN
                                                              ReportPrint.PrintGenJnlLine(Rec);
                                                            END;
                                                             }
                                                   { ID=46;
                                                     ShortCutKey=F11;
                                                     CaptionML=[DEU=Bu&chen;
                                                                ENU=P&ost];
                                                     OnPush=BEGIN
                                                              CODEUNIT.RUN(CODEUNIT::"Gen. Jnl.-Post",Rec);
                                                              CurrentJnlBatchName := GETRANGEMAX("Journal Batch Name");
                                                              CurrForm.UPDATE(FALSE);
                                                            END;
                                                             }
                                                   { ID=47;
                                                     ShortCutKey=Shift+F11;
                                                     CaptionML=[DEU=Buchen und d&rucken;
                                                                ENU=Post and &Print];
                                                     OnPush=BEGIN
                                                              CODEUNIT.RUN(CODEUNIT::"Gen. Jnl.-Post+Print",Rec);
                                                              CurrentJnlBatchName := GETRANGEMAX("Journal Batch Name");
                                                              CurrForm.UPDATE(FALSE);
                                                            END;
                                                             }
                                                 }
                                                  }
    { 48  ;CommandButton;14630;8360 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=FormHelp }
    { 57  ;MenuButton   ;2530 ;8360 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[DEU=&Zeile;
                                                            ENU=&Line];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=58;
                                                     PushAction=RunObject;
                                                     ShortCutKey=Shift+Ctrl+D;
                                                     CaptionML=[DEU=Dimensionen;
                                                                ENU=Dimensions];
                                                     RunObject=Form 545;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Table ID=CONST(81),
                                                                 Journal Template Name=FIELD(Journal Template Name),
                                                                 Journal Batch Name=FIELD(Journal Batch Name),
                                                                 Journal Line No.=FIELD(Line No.) }
                                                 }
                                                  }
    { 40  ;MenuButton   ;7370 ;8360 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[DEU=F&unktion;
                                                            ENU=F&unctions];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=93;
                                                     PushAction=RunObject;
                                                     ShortCutKey=Shift+F9;
                                                     Ellipsis=Yes;
                                                     CaptionML=[DEU=Posten ausgleichen;
                                                                ENU=Apply Entries];
                                                     RunObject=Codeunit 225 }
                                                   { ID=94;
                                                     PushAction=RunObject;
                                                     CaptionML=[DEU=Rundungszeilen f. MW-Konvertierung einfÅgen;
                                                                ENU=Insert Conv. LCY Rndg. Lines];
                                                     RunObject=Codeunit 407 }
                                                 }
                                                  }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'DEU=Scheck %1 annullieren?;ENU=Void Check %1?';
      Text001@1001 : TextConst 'DEU=Alle gedruckten Schecks annullieren?;ENU=Void all printed checks?';
      ChangeExchangeRate@1002 : Form 511;
      GenJnlLine@1003 : Record 81;
      GenJnlLine2@1004 : Record 81;
      GLReconcile@1005 : Form 345;
      CreateVendorPmtSuggestion@1006 : Report 393;
      GenJnlManagement@1007 : Codeunit 230;
      ReportPrint@1008 : Codeunit 228;
      DocPrint@1009 : Codeunit 229;
      CheckManagement@1010 : Codeunit 367;
      CurrentJnlBatchName@1011 : Code[10];
      AccName@1012 : Text[50];
      BalAccName@1013 : Text[50];
      Balance@1014 : Decimal;
      TotalBalance@1015 : Decimal;
      ShowBalance@1016 : Boolean;
      ShowTotalBalance@1017 : Boolean;
      ShortcutDimCode@1018 : ARRAY [8] OF Code[20];
      OpenedFromBatch@1019 : Boolean;
      VendLedgEntry@1150000 : Record 25;
      Vend@1150014 : Record 23;
      AgeDays@1150013 : Integer;
      PaymDiscDays@1150012 : Integer;
      DueDays@1150011 : Integer;
      OeRemainAmountFC@1150010 : Decimal;
      PaymDiscDeductAmount@1150008 : Decimal;
      RemainAfterPayment@1150006 : Decimal;
      TotalPayAmount@1150005 : Decimal;
      PmtDiscount@1150007 : Decimal;
      AcceptedPaymentTol@1150009 : Decimal;

    LOCAL PROCEDURE UpdateBalance@1();
    VAR
      TempGenJourLine@1150000 : Record 81;
      TmpLineNo@1150001 : Integer;
    BEGIN
      GenJnlManagement.CalcBalance(
        Rec,xRec,Balance,TotalBalance,ShowBalance,ShowTotalBalance);
      CurrForm.Balance.VISIBLE := ShowBalance;
      CurrForm.TotalBalance.VISIBLE := ShowTotalBalance;

      TotalPayAmount := 0;
      TempGenJourLine.COPY(Rec);

      IF "Line No." = 0 THEN
        TmpLineNo := xRec."Line No."
      ELSE
        TmpLineNo := "Line No.";

      TempGenJourLine.MARKEDONLY(TRUE);
      IF TempGenJourLine.FIND('-') THEN
      REPEAT
        TotalBalance := TotalBalance - TempGenJourLine."Balance (LCY)";
        IF TempGenJourLine."Line No." <= TmpLineNo THEN
          Balance := Balance - TempGenJourLine."Balance (LCY)";
        IF (TempGenJourLine."Document Type" = TempGenJourLine."Document Type"::Payment) AND
           (TempGenJourLine."Account Type" = TempGenJourLine."Account Type"::Vendor)
        THEN
          TotalPayAmount := TotalPayAmount - (-TempGenJourLine."Amount (LCY)");
      UNTIL TempGenJourLine.NEXT = 0;
      TempGenJourLine.MARKEDONLY(FALSE);

      IF NOT TempGenJourLine.FIND('-') THEN BEGIN
        Balance := 0;
        TotalBalance := 0;
      END;

      TempGenJourLine.SETCURRENTKEY("Journal Template Name","Journal Batch Name","Account Type","Document Type");
      TempGenJourLine.SETRANGE("Document Type",TempGenJourLine."Document Type"::Payment);
      TempGenJourLine.SETRANGE("Account Type",TempGenJourLine."Account Type"::Vendor);
      IF TempGenJourLine.CALCSUMS("Amount (LCY)") THEN BEGIN
        TotalPayAmount := TotalPayAmount + (-TempGenJourLine."Amount (LCY)");
        CurrForm.TotalPayment.VISIBLE(TRUE);
      END ELSE
        CurrForm.TotalPayment.VISIBLE(FALSE);
    END;

    PROCEDURE UpdateInfoBox@2();
    VAR
      ExchRate@1150000 : Record 330;
      Currency@1150001 : Record 4;
    BEGIN
      AgeDays := 0;
      PaymDiscDays := 0;
      DueDays := 0;
      OeRemainAmountFC := 0;
      PaymDiscDeductAmount := 0;
      RemainAfterPayment := 0;
      PmtDiscount := 0;
      AcceptedPaymentTol := 0;

      VendLedgEntry.INIT;
      Vend.INIT;

      IF "Applies-to Doc. No." = '' THEN
        EXIT;

      VendLedgEntry.SETCURRENTKEY("Document No.");
      VendLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
      VendLedgEntry.SETRANGE("Document No.","Applies-to Doc. No.");
      IF NOT VendLedgEntry.FIND('-') THEN
        EXIT;

      IF Currency.READPERMISSION THEN
        IF Currency.GET("Currency Code") THEN
          Currency.InitRoundingPrecision;
      // Std. Zahlungsbedinungen holen
      IF NOT Vend.GET(VendLedgEntry."Vendor No.") THEN;

      // Calculate Days for Age, Payment Discount
      IF "Posting Date" > 0D THEN BEGIN
        IF VendLedgEntry."Posting Date" > 0D THEN
          AgeDays := "Posting Date" - VendLedgEntry."Posting Date";
        IF VendLedgEntry."Pmt. Discount Date" > 0D THEN
          PaymDiscDays := VendLedgEntry."Pmt. Discount Date" - "Posting Date";
        IF VendLedgEntry."Due Date" > 0D THEN
          DueDays := VendLedgEntry."Due Date" - "Posting Date";
      END;

      VendLedgEntry.CALCFIELDS("Remaining Amount","Remaining Amt. (LCY)");
      OeRemainAmountFC := -VendLedgEntry."Remaining Amount";
      PmtDiscount :=  -VendLedgEntry."Remaining Pmt. Disc. Possible";
      PmtDiscount :=
        ExchRate.ExchangeAmtFCYToFCY("Posting Date",VendLedgEntry."Currency Code",
          "Currency Code",-VendLedgEntry."Remaining Pmt. Disc. Possible");
      PmtDiscount := ROUND(PmtDiscount,Currency."Amount Rounding Precision");


      // calculate FC-amount of open entries and remaining amount
      IF VendLedgEntry."Currency Code" <> "Currency Code" THEN BEGIN
        OeRemainAmountFC :=
          ExchRate.ExchangeAmtLCYToFCY(
          "Posting Date","Currency Code",-VendLedgEntry."Remaining Amt. (LCY)","Currency Factor");
        OeRemainAmountFC := ROUND(OeRemainAmountFC,Currency."Amount Rounding Precision");
      END;

      IF (VendLedgEntry."Pmt. Discount Date" >= "Posting Date") OR
         ((VendLedgEntry."Pmt. Disc. Tolerance Date" >= "Posting Date") AND
         (VendLedgEntry."Accepted Pmt. Disc. Tolerance"))
      THEN BEGIN
        PaymDiscDeductAmount := -VendLedgEntry."Remaining Pmt. Disc. Possible";
        IF VendLedgEntry."Currency Code" <> "Currency Code" THEN
          PaymDiscDeductAmount :=
            ExchRate.ExchangeAmtFCYToFCY(
              "Posting Date",VendLedgEntry."Currency Code","Currency Code",PaymDiscDeductAmount);
      END;
      PaymDiscDeductAmount := ROUND(PaymDiscDeductAmount,Currency."Amount Rounding Precision");

      AcceptedPaymentTol := -VendLedgEntry."Accepted Payment Tolerance";
        IF VendLedgEntry."Currency Code" <> "Currency Code" THEN
          AcceptedPaymentTol :=
            ExchRate.ExchangeAmtFCYToFCY(
              "Posting Date",VendLedgEntry."Currency Code","Currency Code",AcceptedPaymentTol);
      AcceptedPaymentTol := ROUND(AcceptedPaymentTol,Currency."Amount Rounding Precision");

      CASE TRUE OF
        "Account Type" = "Account Type"::Vendor:
          RemainAfterPayment := OeRemainAmountFC - Amount - PaymDiscDeductAmount -
            AcceptedPaymentTol;
        "Bal. Account Type" = "Bal. Account Type"::Vendor:
          RemainAfterPayment := OeRemainAmountFC + Amount - PaymDiscDeductAmount -
            AcceptedPaymentTol;
      END;

      CurrForm.RemainAfterPayment.VISIBLE(TRUE);
      IF ("Currency Code" <> VendLedgEntry."Currency Code") AND
        (("Currency Code" <> '') AND (VendLedgEntry."Currency Code" <> ''))
      THEN BEGIN
         CurrForm.RemainAfterPayment.VISIBLE(FALSE);
         EXIT;
      END;

      // Pmt. Disc is not applied if entry is not closed
      IF RemainAfterPayment > 0 THEN BEGIN
        RemainAfterPayment := RemainAfterPayment + PaymDiscDeductAmount;
        PaymDiscDeductAmount := 0;
      END;
    END;

    BEGIN
    END.
  }
}

